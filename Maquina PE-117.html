<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reporte de Guardia - PE-117</title>

  <!-- Librer√≠as -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background-color: #ecf0f3;
      color: #003366;
    }
    h1, h2 {
      text-align: center;
      margin: 6px 0;
    }
    .buttons {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
    }
    .btn {
      background-color: #f9cd00;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
    }
    .btn:hover {
      background-color: #002752;
    }
    #reporte {
      width: 800px;
      margin: auto;
      background: white;
      padding: 30px;
      box-sizing: border-box;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1px;
      font-size: 8px;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 1px;
      text-align: left;
    }
    th {
      background-color: #dde6f3;
    }
    input, textarea {
      width: 100%;
      font-size: 8px;
      border: none;
      background: transparent;
      color: #003366;
    }
    input:focus, textarea:focus {
      outline: 2px solid #f9cd00;
      background-color: #fffef5;
    }
    textarea {
      resize: none;
      overflow: hidden;
      white-space: pre-wrap;
      word-wrap: break-word;
      min-height: 60px;
    }
    @media print {
      body {
        background: white;
      }
      #reporte {
        width: auto;
        margin: 0;
        padding: 0;
      }
      .buttons {
        display: none;
      }
    }
  </style>
</head>
<body>
  <h1>üìã GEOTEC - Reporte de Guardia</h1>
  <h2>M√°quina PE-117</h2>

  <div class="buttons">
    <button class="btn" id="btnPDF">üìÑ PDF</button>
    <button class="btn" id="btnExcel">üìä Excel</button>
  </div>

  <div id="reporte">

    <div style="display:flex; align-items:center; width:100%; padding:4px 8px; border-bottom: #ccc">

   <!-- üß≠ GEOTEC bien pegado a la izquierda -->
  <div style="margin-right:auto">
    <h2 style="font-size:20px; margin:0">GEOTEC</h2>
  </div>
  <!-- REPORTE DE GUARDIA centrado -->
   <div style="flex:1; text-align:center">
    <h2 style="font-size:16px; margin:0">REPORTE DE GUARDIA</h2>
  </div>
  <!-- Unidad + input a la derecha -->
    <div style="margin-right:auto">
    <label for="unidad" style="font-size:14px">Unidad: Las Bambas</label>

  </div>

</div>

<!-- Datos generales -->
<table style="width:100%; table-layout:fixed; font-size:8px">
  <tr>
    <th>ZONA</th><td><input id="zona" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
    <th>FECHA</th><td><input id="fecha" type="date" style="width:100%; height:var(--inputHeight,16px)"></td>
    <th>TURNO</th><td><input id="turno" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
    <th>SONDAJE</th><td><input id="sondaje" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
    <th>M√ÅQUINA</th><td><input id="maquina" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
  </tr>
  <tr>
    <th>PROGRAMA</th><td><input id="prog" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
    <th>AZIMUTH</th><td><input id="az" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
    <th>INCLINACI√ìN</th><td><input id="dip" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
    <th>PRECOLL</th><td><input id="precoll" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
    <th>PLATAFORMA</th><td><input id="plataforma" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
  </tr>
</table>

<table style="width:100%; table-layout:fixed">
  <tr valign="top">

  <!-- Columna: Perforaci√≥n -->
<td style="width:35%; padding-right:8px">
  <h3>üõ†Ô∏è Perforaci√≥n</h3>
  <table style="width:100%; table-layout:fixed; font-size:8px">
    <tr>
      <td style="background:#dde6f3; font-weight:bold"><label for="long_tuberia">Long de tub al final del turno</label></td>
      <td><input id="long_tuberia" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td style="background:#dde6f3; font-weight:bold"><label for="tamano">Tama√±o Diametro</label></td>
      <td><input id="tama√±o diametro" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td style="background:#dde6f3; font-weight:bold"><label for="sobrante">Sobrante al final del turno</label></td>
      <td><input id="sobrante" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td style="background:#dde6f3; font-weight:bold"><label for="prof_inicial">Profundidad al final del turno</label></td>
      <td><input id="prof_inicial" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td style="background:#dde6f3; font-weight:bold"><label for="prof_final">Profundidad al inicio del turno</label></td>
      <td><input id="prof_final" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td style="background:#dde6f3; font-weight:bold"><label for="perforado">Perforado</label></td>
      <td><input id="perforado" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td style="background:#dde6f3; font-weight:bold"><label for="recuperacion">Muestra de recuperaci√≥n</label></td>
      <td><input id="recuperacion" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
  </table>
</td>
    <!-- Columna: Aditivos -->
<td style="width:25%; padding-right:10px">
  <h3>üß™ Aditivos</h3>
  <table style="width:100%; border-collapse:collapse">
    <tr>
      <th style="width:60%">Descripci√≥n</th>
      <th style="width:20%">Unidad</th>
      <th style="width:20%">Cantidad</th>
    </tr>
    <!-- 7 filas -->
    <tr>
      <td><input id="aditivo_desc_1" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_uni_1" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_cant_1" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td><input id="aditivo_desc_2" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_uni_2" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_cant_2" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td><input id="aditivo_desc_3" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_uni_3" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_cant_3" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td><input id="aditivo_desc_4" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_uni_4" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_cant_4" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td><input id="aditivo_desc_5" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_uni_5" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_cant_5" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td><input id="aditivo_desc_6" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_uni_6" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_cant_6" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
    <tr>
      <td><input id="aditivo_desc_7" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_uni_7" type="text" style="width:100%; height:var(--inputHeight,16px)"></td>
      <td><input id="aditivo_cant_7" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
    </tr>
  </table>
</td>

    <!-- Columna: Revestimiento -->
<td style="width:33%">
  <h3>üß± Revestimiento</h3>
  <table style="width:95%; border-collapse:collapse">
    <tr><th>Tipo</th><th>Metros</th></tr>
    <tr><td>PWT</td><td><input id="revest_pwwt" type="text" style="width:100%"></td></tr>
    <tr><td>HWT</td><td><input id="revest_hwt" type="text" style="width:100%"></td></tr>
    <tr><td>HQ</td><td><input id="revest_hq" type="text" style="width:100%"></td></tr>
  </table>

  <!-- ü™® Condici√≥n de la roca -->
<h3 style="margin-top:8px; margin-bottom:4px; font-size:8px">ü™® Condici√≥n de la roca</h3>
<table style="font-size:8x; border-collapse:collapse">
  <tr>
    <td style="padding:2px">Compacto</td>
    <td style="padding:2px">
      <input type="text" style="width:14px; height:var(--inputHeight,16px); text-align:center; font-size:7px">
    </td>
    <td style="padding:2px">Duro</td>
    <td style="padding:2px">
      <input type="text" style="width:14px; height:var(--inputHeight,16px); text-align:center; font-size:7px">
    </td>
  </tr>
  <tr>
    <td style="padding:2px">Semicompacto</td>
    <td style="padding:2px">
      <input type="text" style="width:14px; height:var(--inputHeight,16px); text-align:center; font-size:7px">
    </td>
    <td style="padding:2px">Semi Duro</td>
    <td style="padding:2px">
      <input type="text" style="width:14px; height:var(--inputHeight,16px); text-align:center; font-size:7px">
    </td>
  </tr>
  <tr>
    <td style="padding:2px">Fracturado</td>
    <td style="padding:2px">
      <input type="text" style="width:14px; height:var(--inputHeight,16px); text-align:center; font-size:7px">
    </td>
    <td style="padding:2px">Suave</td>
    <td style="padding:2px">
      <input type="text" style="width:14px; height:var(--inputHeight,16px); text-align:center; font-size:7px">
    </td>
  </tr>
</table>

<!-- Columna derecha: Hor√≥metro + Abastecimiento + Evacuaci√≥n -->
<td style="width:20%; vertical-align:top">
 
<!-- Hor√≥metro -->
<h3 style="margin-bottom:6px; font-size:8px">‚è±Ô∏è Hor√≥metro</h3>
<table style="width:100%; font-size:8px; margin-bottom:8px; table-layout:fixed">
  <tr>
    <td style="background:#dde6f3; font-weight:bold; height:var(--inputHeight,px); vertical-align:middle">
      <label for="horometro_inicio">Inicio</label>
    </td>
    <td style="height:var(--inputHeight,px)">
      <input id="horometro_inicio" type="text" style="width:100%; height:var(--inputHeight,px)">
    </td>
  </tr>
  <tr>
    <td style="background:#dde6f3; font-weight:bold; height:var(--inputHeight,px); vertical-align:middle">
      <label for="horometro_fin">Final</label>
    </td>
    <td style="height:var(--inputHeight,px)">
      <input id="horometro_fin" type="text" style="width:100%; height:var(--inputHeight,px)">
    </td>
  </tr>
</table>

  <!-- Abastecimiento de combustible -->
<h3 style="margin-bottom:6px; font-size:8px">‚õΩ Abto. de combustible</h3>
<table style="width:100%; font-size:8px; margin-bottom:8px; table-layout:fixed">
  <tr>
    <td style="background:#dde6f3; font-weight:bold; height:var(--inputHeight,px); vertical-align:middle">
      <label for="combustible_tipo">Galones</label>
    </td>
    <td style="height:var(--inputHeight,px)">
      <input id="combustible_tipo" type="text" style="width:100%; height:var(--inputHeight,px)">
    </td>
  </tr>
</table>

  <!-- Evacuaci√≥n de lodo -->
<h3 style="margin-bottom:6px; font-size:8px">ü™£ Evacuaci√≥n de lodo</h3>
<table style="width:100%; font-size:8px; table-layout:fixed">
  <tr>
    <td style="background:#dde6f3; font-weight:bold; height:var(--inputHeight,px); vertical-align:middle">
      <label for="lodo_tipo">Galones</label>
    </td>
    <td style="height:var(--inputHeight,px)">
      <input id="lodo_tipo" type="text" style="width:100%; height:var(--inputHeight,px)">
    </td>
  </tr>
</table>
</td>

  </tr>
</table>

<!-- üîß Contenedor principal en dos columnas -->
<div style="display:flex; gap:12px; align-items:flex-start">

  <!-- üìê Procesos de perforaci√≥n (izquierda) -->
<div style="flex:2">
  <h3 style="font-size:9px; margin-bottom:6px">üìê Procesos de perforaci√≥n</h3>
  <table style="width:95%; table-layout:fixed; border-collapse:collapse; font-size:8px" border="1">
    <colgroup>
      <col style="width:12%">
      <col style="width:12%">
      <col style="width:6%">
      <col style="width:10%">
      <col style="width:6%">
      <col style="width:10%">
      <col style="width:8%">
      <col style="width:7%">
    </colgroup>
    <tbody>
      <!-- Rimado -->
      <tr>
        <td style="background:#dde6f3; font-weight:bold">Rimado</td>
        <td><input id="rimado_c1" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Desde</td>
        <td><input id="rimado_c2" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Hasta</td>
        <td><input id="rimado_c3" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Tama√±o</td>
        <td><input id="rimado_c4" type="text" style="width:100%"></td>
      </tr>
      <!-- Ensanchado -->
      <tr>
        <td style="background:#dde6f3; font-weight:bold">Ensanchado</td>
        <td><input id="ensanchado_c1" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Desde</td>
        <td><input id="ensanchado_c2" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Hasta</td>
        <td><input id="ensanchado_c3" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Tama√±o</td>
        <td><input id="ensanchado_c4" type="text" style="width:100%"></td>
      </tr>
      <!-- Revestimiento -->
      <tr>
        <td style="background:#dde6f3; font-weight:bold">Revestimiento</td>
        <td><input id="revestimiento_c1" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Desde</td>
        <td><input id="revestimiento_c2" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Hasta</td>
        <td><input id="revestimiento_c3" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Tama√±o</td>
        <td><input id="revestimiento_c4" type="text" style="width:100%"></td>
      </tr>
      <!-- Tricono -->
      <tr>
        <td style="background:#dde6f3; font-weight:bold">Perf con tricono</td>
        <td><input id="tricono_c1" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Desde</td>
        <td><input id="tricono_c2" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Hasta</td>
        <td><input id="tricono_c3" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Tama√±o</td>
        <td><input id="tricono_c4" type="text" style="width:100%"></td>
      </tr>
      <!-- Reperforado -->
      <tr>
        <td style="background:#dde6f3; font-weight:bold">Reperforado</td>
        <td><input id="reperforado_c1" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Desde</td>
        <td><input id="reperforado_c2" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Hasta</td>
        <td><input id="reperforado_c3" type="text" style="width:100%"></td>
        <td style="text-align:center; background:#dde6f3; font-weight:bold">Tama√±o</td>
        <td><input id="reperforado_c4" type="text" style="width:100%"></td>
      </tr>
    </tbody>
  </table>
</div>

  <!-- üìê Pruebas de inclinaci√≥n (derecha) -->
  <div style="flex:1">
    <h3 style="font-size:8px; margin-bottom:px">üìê Pruebas de inclinaci√≥n</h3>
    <table style="width:90%; table-layout:fixed; font-size:px; border-collapse:collapse" border="">
      <tr>
        <th style="width:34%">Profundidad</th>
        <th style="width:33%">Azimut</th>
        <th style="width:33%">Inclinaci√≥n</th>
      </tr>
      <tr>
        <td><input id="inclinacion_prof_1" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
        <td><input id="inclinacion_azim_1" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
        <td><input id="inclinacion_inc_1" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
      </tr>
      <tr>
        <td><input id="inclinacion_prof_2" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
        <td><input id="inclinacion_azim_2" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
        <td><input id="inclinacion_inc_2" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
      </tr>
      <tr>
        <td><input id="inclinacion_prof_3" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
        <td><input id="inclinacion_azim_3" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
        <td><input id="inclinacion_inc_3" type="number" style="width:100%; height:var(--inputHeight,16px)"></td>
      </tr>
      <!-- ... puedes continuar hasta la fila 7 si lo deseas -->
    </table>
  </div>

</div>
<!-- üîß Fila: Brocas/Zapata/R Shell/Tricono + Fluido -->
<div style="display:flex; gap:12px; align-items:flex-start; margin-top:12px">

  <!-- üî© Brocas/Zapata/R Shell/Tricono -->
<div style="flex:1">
  <h3 style="font-size:8px; margin-bottom:px">üî© Brocas/Zapata/R Shell/Tricono</h3>
  <table style="width:100%; border-collapse:collapse; font-size:8px" border="1">
    <colgroup>
      <col style="width:18%"> <!-- Etiqueta -->
      <col style="width:20%"> <!-- Campo 1 -->
      <col style="width:20%"> <!-- Campo 2 -->
      <col style="width:20%"> <!-- Campo 3 -->
      <col style="width:22%"> <!-- Campo 4 -->
    </colgroup>
    <tbody>
      <tr>
        <td style="font-weight:bold; background:#dde6f3; padding:2px"><label for="broca_desc_1">Descripci√≥n</label></td>
        <td><input id="broca_desc_1" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_desc_2" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_desc_3" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_desc_4" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
      </tr>
      <tr>
        <td style="font-weight:bold; background:#dde6f3; padding:2px"><label for="broca_serie_1">N¬∞ de serie</label></td>
        <td><input id="broca_serie_1" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_serie_2" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_serie_3" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_serie_4" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
      </tr>
      <tr>
        <td style="font-weight:bold; background:#dde6f3; padding:2px"><label for="broca_desde_1">Desde</label></td>
        <td><input id="broca_desde_1" type="number" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_desde_2" type="number" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_desde_3" type="number" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_desde_4" type="number" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
      </tr>
      <tr>
        <td style="font-weight:bold; background:#dde6f3; padding:2px"><label for="broca_hasta_1">Hasta</label></td>
        <td><input id="broca_hasta_1" type="number" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_hasta_2" type="number" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_hasta_3" type="number" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_hasta_4" type="number" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
      </tr>
      <tr>
        <td style="font-weight:bold; background:#dde6f3; padding:2px"><label for="broca_cond_1">Condici√≥n</label></td>
        <td><input id="broca_cond_1" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_cond_2" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_cond_3" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
        <td><input id="broca_cond_4" type="text" style="width:100%; height:var(--inputHeight,14px); font-size:8px"></td>
      </tr>
    </tbody>
  </table>
</div>

  <!-- Fluido -->
   
  <div style="flex:1">
    <h3 style="font-size:8px; margin-bottom:px">üíß Fluido</h3>
    <table style="width:70%; table-layout:fixed; font-size:8px; border-collapse:collapse" border="1">
      <tr>
        <td style="background:#dde6f3; font-weight:bold"><label for="fluido_agua">Agua(gal)</label></td>
        <td><input id="fluido_agua" type="text" style="width:100%; height:var(--inputHeight,10px)"></td>
      </tr>
      <tr>
        <td style="background:#dde6f3; font-weight:bold"><label for="fluido_espuma">PH</label></td>
        <td><input id="fluido_espuma" type="text" style="width:100%; height:var(--inputHeight,10px)"></td>
      </tr>
      <tr>
        <td style="background:#dde6f3; font-weight:bold"><label for="fluido_polimero">CA++</label></td>
        <td><input id="fluido_polimero" type="text" style="width:100%; height:var(--inputHeight,10px)"></td>
      </tr>
      <tr>
        <td style="background:#dde6f3; font-weight:bold"><label for="fluido_bentonita">Viscosidad (s/q)</label></td>
        <td><input id="fluido_bentonita" type="text" style="width:100%; height:var(--inputHeight,10px)"></td>
      </tr>
      <tr>
        <td style="background:#dde6f3; font-weight:bold"><label for="fluido_espumante">Retorno (%)</label></td>
        <td><input id="fluido_espumante" type="text" style="width:100%; height:var(--inputHeight,10px)"></td>
      </tr>
      <tr>
        <td style="background:#dde6f3; font-weight:bold"><label for="fluido_aditivo">Nivel(m)</label></td>
        <td><input id="fluido_aditivo" type="text" style="width:100%; height:var(--inputHeight,10px)"></td>
      </tr>
      <tr>
      </tr>
    </table>
  </div>

</div>


<!-- üïí Cargo de tiempos (en horas) -->
<h3 style="font-size:9px; margin-top:16px; margin-bottom:5px">üïí Cargo de tiempos (en horas)</h3>
<table style="width:100%; table-layout:fixed; border-collapse:collapse; font-size:8px" border="1">
  <colgroup>
    <col style="width:10%">  <!-- C√≥digo -->
    <col style="width:60%">  <!-- Actividad -->
    <col style="width:10%">  <!-- Hora Inicio -->
    <col style="width:10%">  <!-- Hora Final -->
    <col style="width:10%">  <!-- Cant. de hrs -->
    <col style="width:10%">  <!-- Hora cobrable -->
    <col style="width:10%">  <!-- HNC -->
  </colgroup>
  <thead style="background-color:#f0f0f0">
    <tr>
      <th>C√≥digo</th>
      <th>Actividad</th>
      <th>Hora Inicio</th>
      <th>Hora Final</th>
      <th>Cant. de hrs</th>
      <th>Hora cobrable</th>
      <th>HNC</th>
    </tr>
  </thead>
  <tbody>
    <!-- 14 filas -->
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
    <tr><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="number" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td><td><input type="text" style="width:100%"></td></tr>
  </tbody>
</table>

<!-- üìù Comentarios -->
<h3 style="font-size:9px; margin-top:8px; margin-bottom:4px">üìù Comentarios</h3>
<div id="comentarios" contenteditable="true" style="
  width:100%;
  min-height:60px;
  font-size:8px;
  padding:4px;
  border:1px solid #999;
  border-radius:4px;
  background-color:#fff;
  white-space:pre-wrap;
  word-wrap:break-word;
  box-sizing:border-box;
  outline:none;
">
</div>

<!-- üë• Personal en tabla -->
<table style="width:100%; font-size:8px; border-collapse:collapse; margin-top:8px">
  <tr>
    <td style="padding:2px 4px; border:1px solid #999; width:12%; background:#dde6f3; font-weight:bold; vertical-align:middle">SUPERVISOR</td>
    <td style="padding:2px 4px; border:1px solid #999; vertical-align:middle">
      <input id="supervisor" type="text" style="width:100%; font-size:8px; padding:2px; border:0px solid #999; border-radius:4px">
    </td>
  </tr>
  <tr>
    <td style="padding:2px 4px; border:1px solid #999; background:#dde6f3; font-weight:bold; vertical-align:middle">PERFORISTA</td>
    <td style="padding:2px 4px; border:1px solid #999; vertical-align:middle">
      <input id="perforista" type="text" style="width:100%; font-size:8px; padding:2px; border 0px solid #999; border-radius:4px">
    </td>
  </tr>
  <tr>
    <td style="padding:2px 4px; border:1px solid #999; background:#dde6f3; font-weight:bold; vertical-align:middle">AYUDANTE 1</td>
    <td style="padding:2px 4px; border:1px solid #999; vertical-align:middle">
      <input id="ayudante1" type="text" style="width:100%; font-size:8px; padding:2px; border:0px solid #999; border-radius:4px">
    </td>
  </tr>
  <tr>
    <td style="padding:2px 4px; border:1px solid #999; background:#dde6f3; font-weight:bold; vertical-align:middle">AYUDANTE 2</td>
    <td style="padding:2px 4px; border:1px solid #999; vertical-align:middle">
      <input id="ayudante2" type="text" style="width:100%; font-size:8px; padding:2px; border:0px solid #999; border-radius:4px">
    </td>
  </tr>
  <tr>
    <td style="padding:2px 4px; border:1px solid #999; background:#dde6f3; font-weight:bold; vertical-align:middle">AYUDANTE 3</td>
    <td style="padding:2px 4px; border:1px solid #999; vertical-align:middle">
      <input id="ayudante3" type="text" style="width:100%; font-size:8px; padding:2px; border:0px solid #999; border-radius:4px">
    </td>
  </tr>
</table>

<!-- ‚úçÔ∏è Firmas institucionales con espacio visible -->
<table style="width:100%; font-size:8px; border-collapse:collapse; margin-top:16px">
  <colgroup>
    <col style="width:50%">
    <col style="width:50%">
  </colgroup>
  <tr>
    <!-- Firma GEOTEC -->
    <td style="padding:12px 6px; vertical-align:bottom; text-align:center; height:60px">
      <div style="border-top:1px solid #000; width:80%; margin:0 auto 6px auto"></div>
      <div style="font-weight:bold">Representante de GEOTEC</div>
    </td>

    <!-- Firma Cliente -->
    <td style="padding:12px 6px; vertical-align:bottom; text-align:center; height:60px">
      <div style="border-top:1px solid #000; width:80%; margin:0 auto 6px auto"></div>
      <div style="font-weight:bold">Representante del Cliente</div>
    </td>
  </tr>
</table>

  <script>
    const campos = ["zona1", "fecha", "zona2", "zona3", "turno", "observaciones"];

    // Cargar valores desde localStorage
    campos.forEach(id => {
      const el = document.getElementById(id);
      if (el) {
        el.value = localStorage.getItem(id) || "";
        el.addEventListener("input", () => {
          localStorage.setItem(id, el.value);
        });
      }
    });

     // Bot√≥n PDF
    document.getElementById("btnPDF").addEventListener("click", () => {
      if (!window.jspdf || !window.jspdf.jsPDF) {
        alert("jsPDF a√∫n no est√° listo. Intenta nuevamente.");
        return;
      }

      const jsPDF = window.jspdf.jsPDF;
      const original = document.getElementById("reporte");
      const clon = original.cloneNode(true);

      clon.querySelectorAll("input, textarea").forEach(el => {
        const div = document.createElement("div");
        div.textContent = el.value;
        div.style.border = "0px solid #ccc";
        div.style.padding = "2px";
        div.style.minHeight = "8px";
        div.style.fontSize = "8px";
        el.parentNode.replaceChild(div, el);
      });

      clon.style.position = "absolute";
      clon.style.left = "-9999px";
      document.body.appendChild(clon);

      html2canvas(clon, { scale: 2 }).then(canvas => {
        const imgData = canvas.toDataURL("image/png");
        const pdf = new jsPDF("p", "mm", "a4");
        const pageWidth = pdf.internal.pageSize.getWidth();
        const pageHeight = pdf.internal.pageSize.getHeight();
        const imgWidth = pageWidth;
        const imgHeight = canvas.height * imgWidth / canvas.width;

        let position = 0;
        if (imgHeight <= pageHeight) {
          pdf.addImage(imgData, "PNG", 0, 0, imgWidth, imgHeight);
        } else {
          while (position < imgHeight) {
            pdf.addImage(imgData, "PNG", 0, -position, imgWidth, imgHeight);
            position += pageHeight;
            if (position < imgHeight) pdf.addPage();
          }
        }

        pdf.save("reporte_PE-151.pdf");
        document.body.removeChild(clon);
      });
    });
    

    // Bot√≥n Excel
   document.getElementById("btnExcel").addEventListener("click", () => {
  const wb = XLSX.utils.book_new();

  // Encabezados en orden espec√≠fico
  const encabezados = [
    "MAQUINA", "TURNO", "SONDAJE", "INCLINACI√ìN", "AZIMUTH", "PROGRAMA",
    "TAMA√ëO DIAMETRO", "PERFORADO", "PROFUNDIDAD AL INICIO DEL TURNO",
    "PROFUNDIDAD AL FINAL DEL TURNO", "COMENTARIOS", "PERFORISTA"
  ];

  // Valores capturados desde los inputs y el div editable
  const valores = [
    document.getElementById("maquina")?.value || "",
    document.getElementById("turno")?.value || "",
    document.getElementById("sondaje")?.value || "",
    document.getElementById("dip")?.value || "",
    document.getElementById("az")?.value || "",
    document.getElementById("prog")?.value || "",
    document.getElementById("tama√±o diametro")?.value || "",
    document.getElementById("perforado")?.value || "",
    document.getElementById("prof_inicial")?.value || "",
    document.getElementById("prof_final")?.value || "",
    document.getElementById("comentarios")?.innerText.trim() || "",
    document.getElementById("perforista")?.value || ""
  ];

  const ws = XLSX.utils.aoa_to_sheet([encabezados, valores]);
  XLSX.utils.book_append_sheet(wb, ws, "Reporte Horizontal");
  XLSX.writeFile(wb, "reporte_PE-151.xlsx");
});
  </script>
</body>
</html>